---
phase: 02-game-core
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/page.tsx
  - components/ControlsPanel.tsx
  - components/GameLayout.tsx
  - lib/game-state.ts
  - app/page.tsx
autonomous: true
must_haves:
  truths:
    - "Home page displays 3-column layout (controls | grid | right panel)"
    - "User can select currency (SOL, USDC, USD1)"
    - "User can set average drill cost via slider (0.01-1000)"
    - "User can set average drill cost via numeric input and +/- buttons"
    - "User can set volatility/risk via slider"
    - "User can toggle Equivalent Chance vs Varied Chance mode"
    - "User can select grid size (3x3, 4x4, 5x5)"
    - "User can see mocked balance and deposit/withdraw UI"
  artifacts:
    - path: components/ControlsPanel.tsx
      provides: "Left panel with all drill controls"
      contains: "grid size"
    - path: components/GameLayout.tsx
      provides: "3-column layout structure"
      contains: "grid-cols"
    - path: lib/game-state.ts
      provides: "Game settings state (React context or Zustand)"
      contains: "averageCost"
  key_links:
    - from: app/page.tsx
      to: components/GameLayout.tsx
      via: "render"
      pattern: "GameLayout"
---

<objective>
Build the 3-column game layout and left controls panel with all drill settings. Right panel is a placeholder for Phase 4 (chat/stats).

Purpose: LAYOUT-03, CTRL-01 through CTRL-08. User can configure the game before drilling.
Output: Functional controls panel, layout structure, game state.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

From spec: Currency SOL/USDC/USD1. Avg drill cost 0.01-1000. Volatility 0-1. Chance modes: Equivalent (same odds) / Varied (odds vary by tile cost). Grid 3x3, 4x4, 5x5 (default 5x5).
</context>

<tasks>

<task type="auto">
  <name>Task 1: Game state and layout structure</name>
  <files>lib/game-state.ts, components/GameLayout.tsx</files>
  <action>
    Create lib/game-state.ts: React context (or Zustand store) holding: currency ('SOL'|'USDC'|'USD1'), averageDrillCost (number, default 0.25), volatility (0-1, default 0.5), chanceMode ('equivalent'|'varied'), gridSize (3|4|5, default 5), balance (mocked, e.g. 10).
    Create components/GameLayout.tsx: 3-column grid layout. Left: 280px or w-72, Center: flex-1 min-w-0, Right: 280px or w-72. Use Tailwind grid (grid-cols-[280px_1fr_280px] or similar). Right column: placeholder div with "Stats & Chat â€” Phase 4" text. Wrap children in GameProvider.
  </action>
  <verify>Layout renders 3 columns; right shows placeholder</verify>
  <done>Game state exists; 3-column layout renders</done>
</task>

<task type="auto">
  <name>Task 2: Controls panel - drill settings</name>
  <files>components/ControlsPanel.tsx</files>
  <action>
    Create ControlsPanel component. Currency selector: 3 buttons or dropdown (SOL, USDC, USD1). Average drill cost: range slider 0.01-1000 (use log scale or steps for usability), numeric input, +/- buttons (step 1 when SOL, 0.01 for decimals). Volatility slider: 0-1. Chance mode: toggle or radio (Equivalent Chance / Varied Chance). Grid size: 3 buttons (3x3, 4x4, 5x5). All wired to game state. Dark premium styling, match theme variables.
  </action>
  <verify>Changing controls updates state; values persist during session</verify>
  <done>All CTRL-01 through CTRL-07 controls work</done>
</task>

<task type="auto">
  <name>Task 3: Controls panel - balance and Mine All button</name>
  <files>components/ControlsPanel.tsx, app/page.tsx</files>
  <action>
    Add to ControlsPanel: Balance display (show mocked balance from state, e.g. "10.00 SOL"). Deposit and Withdraw buttons (no-op for MVP, or increment/decrement balance for demo). Mine All Tiles button - primary CTA, prominent. Wire to a placeholder handler (will connect to grid in 02-02). Update app/page.tsx to render GameLayout with ControlsPanel in left column, empty center (grid in 02-02), placeholder right.
  </action>
  <verify>Balance visible; Deposit/Withdraw/Mine All render; page shows full layout</verify>
  <done>CTRL-08 satisfied; Mine All button present</done>
</task>

</tasks>

<verification>
- [ ] npm run build succeeds
- [ ] Home page shows 3 columns
- [ ] All controls render and update state
- [ ] Balance and Mine All visible
</verification>

<success_criteria>
- 3-column layout on home page
- All drill settings functional
- Game state shared across components
</success_criteria>

<output>
After completion, create .planning/phases/02-game-core/02-01-SUMMARY.md
</output>
